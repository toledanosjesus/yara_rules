rule xmring_all_strings
{
  meta:
    author = "Jesus Toledano"
    creation_date = "2023-12-11"
    threat_name = "cryptominer"
    reference_sample = "770eff289f8f90590f44e1c8a05a00079717ded32aff660f127dfdabe79a5c6b"
    reference_sample = "fa220ddd2bfaaf501f761bb9774c591d16fff4b6220c758e6202eb2eff7bf7c6"
    severity = 100
    vt_collection = "https://www.virustotal.com/gui/collection/ae52a578b40ba0cac6f2a13b6d43e2a25560799139b5c90b1bce8f164d0f7b38/summary"

  strings:
    $0 = {37461F403754D8253F888534A790370226909B57D877251FD45F232714380BFB4D21E21F4838D4F25D21DDA6283454A31F685E21CF15A1842F2990E70A699427B0E70A79AE76C0B47B0E9992CC03E8D4F43324DD21EC2A14DCFB857C57D8E8}
    $1 = "lid variant operation%Invalid variant operation (%s%.8x)\n%s5Could not convert variant of type (%s) into type (%s)=Overflow while converting variant of type (%s) into type (%s)" wide
    $2 = " *@@* $@@($*)@-$*@@$-*@@$*-@@(*$)@-*$@@*-$@@*$-@@-* $@-$ *@* $-@$ *-@$ -*@*- $@($ *)"
    $3 = "ABABABABABABABABABABABABABABABABABABABABAA"
    $4 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA88222823223828"
    $5 = "AAAAAAAEEDDEECEECEECE"
    $6 = "ddddddddddddddddddddddddddddddbbb"
    $7 = {6BC57559795C0826E00FC6677A5B08C4247A69978FA889104EA3FC33A0235A56D1334F6091E16FD8764DF4BE88B2C044C116F6A50915344027A531A45978720DE398190A80F70C6650959F4E87CCDFC9069501DBDD494BC8083056D857}
    $8 = {0C745B0E0CE03286578556023DAC821BCDA4FD6AB344EC80BD1AE5FFC650273964328C160C75039784294336840C284688C015A2EF07F509AF20F740F337832CB4C7A8553FEC742C0A4127874713823EA140DBAAF00683238B0F379AEC}
    $9 = {762F53DF565850DFE713B515605DADF2D628D9B86C8B2D72D35BBCA6612F0F7232573D806B88524C0FF11D330DAF057649379B41E061D69E901438887E50D1C411BFEC869569DFC8D030AA9D5A}
    $10 = {251F841A5A18027D445654B28320DE4860FB4CA12555A85C312B6BA742866EF3DB9C68A0CF564D12A6E28F48BB381E744A20F6B7C1E50DB456072559500EDE2AC127C3ED3414ADB8}
    $11 = {51B477413C391072AA21EA10C61EF495A0E2B52A2B1A63EA8606C812B91AF83C5028B4EBFE3580D245C2430B15AA705475B2FD78EA3C5E8DB56E9189416A6065485826BE29F50E}
    $12 = {4B1D044B88818B70DB45024720195AA642724E2CD2C8DE68114355F4609BB01765F04CB467492469568015BCBA3A1404892827B06C164BD78A0FB2D9C296FB3DCE1416A11741C1}
    $13 = {29EC43F014AB843972F444F8281EBA44AFC2C11D0DB8C40998D942BD08836EF4AA9758417CE34ED8EBF9800FC12BCBB2397D58A01297948BF1A09E2AB7486C1B103BDF07229336}
    $14 = {67137548393BAB28151B2C7640AE8E6D066B9D02183A9D1005531F2E3A822C64099B234AE0B591A279CE812D62082614B75C72C6836CC8134C1AC50CAC303FCADCAAA7}
    $15 = {21AC9EA56668428B50B4A62BA8E17184E075A2088CA485090D365728FABCEC102C08B17B95B6B5371A2DAA8E741E8DA19A39760F1C56120D78550E5DF666BF0E}
    $16 = {5044B095A3E0D580C4B1F22CE494577CB08620616484BD270241B076EAFC424E9BC5311734C63A9EEB6087C0C962772BE4E90B7432C831888910A83A6850201C}
    $17 = {7C434714FBFBD9821C32F9F9450722C8215F19F1F1E490CE50C31D47C9C913724306E908AC829A68F33D0811414839ECF0C41F7D751354BBFE741A5343B30F08}
    $18 = {0D3858C1AC594D0A72E0DC0EA5B77425F14640A17E278812CD82ED806A4063B07322BEC056E05D067D38ABAB59E25CF8E7AB5192FB86ACC684F0D2309D90FB59}
    $19 = {7A6E5C150B3E17A141A60E075965AC8A1C655E862C0FF854B50AA3B84FD49D1187EE78EE14965006FD991B3124411FA3BC62AF2E39B92C11C04CB492934B4E60}
    $20 = {41757D6F1F31A3E16DB4706E5C8272768B785B043710892061288B18DB40876965EB582475A51783EC3164A1653D578EEFB10E47B0AF5CB30C4EFE7913ECC51C}
    $21 = "BABABABABABABABABABABABABABABABABABABABAA]oooomliidbb^^ZZWWUUQQQQOQOOOQOQNAAAAAAAAAAAAAAAAA"
    $22 = "PbqCfibMlfkqbo\x0B@ob^qbCfib>\x0Bpebii0/+aii\x0DPebiiBub`rqb>" wide
    $23 = "idddb````^^^Z^Z^Z^Z^Z^Z^Z^Z^Z^Z^Z^^^ZZZZZYYYWWUUUQQQQOQOOOQOQNAAAAAAAAAAAAAA"
    $24 = "DbqPvpqbjAfob`qlov>\x0DCfkaObplro`b>\x0CIl^aObplro`b" wide
    $25 = "\t\t \x0D\n\t\t<supportedOS Id=\"{8e0f7a12-bfb3-4fe8-b9a5-48fd50a15a9a}\"></supportedOS>\x0D\n"
    $26 = "AAAAAA]poonmkiidd``^ZZWYUSSQQQOOOOOOQQNAAAAAAAAAAAAAAAA@9???993?3?99"
    $27 = "AAAAAAAA]poommkiidbb`ZZZYWUUUQQQOQOOOOQQNAAAAAAAAA@@?@?@@??@?@?@"
    $28 = "AAAAAAAAA]poonmkiidbb`ZZYYWUUUQQQOQOOOOOQNAAAAAAAA@@?@@?@@?@@?@?"
    $29 = "db``ZZZYWYYWWWWWUYUYUYUYUYUYUYUYUYUWUUUUUUUUQQQQQQOOOOOQOQNAAAAA"
    $30 = "`^ZYWWUUQQQOQOQOQOQOQOQOQOQOQOQOQOQOQOQOOOOOOOOOOOQOQNAAAAAAAAAA"
    $31 = "DbqMol`>aaobpp\x0CDbqQbjmM^qe>\x0B@ilpbE^kaib" wide
    $32 = "AAAAAAAAAA]poommkiidbb`^ZYYWUUUQQQOQOOOOQQNAAAAAAA=@?@@@?@@@@@@@"
    $33 = "1!3%3)3-3135393=3A3E3I3M3Q3U3Y3]3a3e3i3m3q3u3I5d7"
    $34 = "AAA]poommkiddbb^^ZZWWUUUQQQOOQOOOQQNAAAAAAAAAAAAAAAAAAA;99999?3??"
    $35 = "AAAAAAAAAAA]poonmkiidbb^^ZYYWUUUQQQOQOOOOOQNAAAAAA@@@?@@@?@@@@@@"
    $36 = "Write$Error creating variant or safe array)Variant or safe array index out of bounds" wide
    $37 = "AAAA]poommkiidbb`^ZZYUUUUQQQQOOOOOQQNAAAAAAAAAAAAA;????????9?9??"
    $38 = "AAAAAA]poommkiidbb`^ZZYWUUUQQQOQOOOOQQNAAAAAAAAAAA@9????????????"
    $39 = "PfwblcObplro`b\x0CIl`hObplro`b\x0CCobbObplro`b" wide
    $40 = "pppppppppppppppppppppppppopooonmmliiidb``ZZZWWUUQQQQOQOOOQOQNAAA"
    $41 = "dOS Id=\"{1f676c76-80e1-4239-95bb-83d0f6d0da78}\"></supportedOS>\x0D\n"
    $42 = "dOS Id=\"{4a2f28e3-53b9-4441-ba9c-d69d4a4a6e38}\"></supportedOS>\x0D\n"
    $43 = "AA]poonmkiidbb`^ZZWWUUQQQQOOOOOOQQNAAAAAAAAAAAAAAAAAA;99999?3?99"
    $44 = "Abstract Error?Access violation at address %p in module '%s'. %s of addre" wide
    $45 = "Invalid class typecast0Access violation at address %p. %s of address %p" wide
    $46 = "Privileged instruction(Exception %s in module %s at %p.\x0D\n%s%s\x0D\n" wide
    $47 = "Application Error1Format '%s' invalid or incompatible with argument" wide
    $48 = "Cannot assign a %s to a %s%String list does not allow duplicates" wide
    $49 = "No argument for format '%s'\"Variant method calls not supported" wide
    $50 = "%s.Seek not implemented$Operation not allowed on sorted list" wide
    $51 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA88283323323332"
    $52 = "AAAAAAAAAECCECECCECCECE"
    $53 = "AAAAAAAAECECECCECCECCC"
    $54 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA88223232332323"
    $55 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA80082082820828"
    $56 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA82828228282222"
    $57 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA88333233333323"
    $58 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA80828222282222"
    $59 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA80808080080800"
    $60 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA88222282222828"
    $61 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAA83283333333233"
    $62 = "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA80000800800808"
  condition:
    all of them
}
